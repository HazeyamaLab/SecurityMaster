<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <h2>具体的な脅威の内容</h2>
    セッションIDが簡易なアルゴリズム（時刻等）によって生成される場合，悪意を持った人間が有効なセッションIDを推測できてしまう可能性があります．
    またネットワークの盗聴等がサれていると，セッションIDが盗まれる可能性もあります．<br>
    <img th:src="@{/imgs/session1.png}" alt=""><br>
    また，推測や盗用以外に，セッション管理の不備を狙ったもう一つの攻撃手法として，「セッション ID の
    固定化（Session Fixation）」と呼ばれる攻撃手法があります．悪意ある人があらかじめ用意したセッション
    ID を，何らかの方法で利用者に送り込み，利用者がこれに気付かずにパスワードを入力するなどして
    ログインすると起こりうる問題です．悪意のある人がこの攻撃に成功すると，あらかじめ用意したセッショ
    ン ID を利用し，利用者になりすましてウェブサイトにアクセスすることができてしまいます．<br>
    <img th:src="@{/imgs/session2.png}" alt="">
    <h2>脅威への対処法</h2>
    <h3>セッション ID を推測が困難なものにする</h3>
    セッション ID が時刻情報等を基に単純なアルゴリズムで生成されている場合，その値は第三者に容
    易に予測されてしまいます．利用者がログインするタイミングで発行されるセッション ID の値を悪意あ
    る人によって推測されると，悪意ある人がそのセッション ID を使って利用者になりすまし，本来は利用
    者しかアクセスできないウェブサイト等にアクセスできてしまいます．セッション ID は，生成アルゴリズ
    ムに暗号論的擬似乱数生成器を用いるなどして，予測困難なものにしてください．<br>
    セッション管理の仕組みが提供されるウェブアプリケーションサーバ製品を利用する場合は，その製
    品が提供するセッション管理の仕組みを利用している限り，自前でセッション ID を生成する必要はあり
    ません．自前でセッション管理の仕組みを構築しようとせず，そうしたウェブアプリケーション製品を利
    用することをお勧めします．
    <h3>セッション ID を URL パラメータに格納しない</h3>
    セッション ID を URL パラメータに格納していると，利用者のブラウザが，Referer 送信機能によって，
    セッション ID の含まれた URL をリンク先のサイトへ送信してしまいます．悪意ある人にその URL を入
    手されると，セッション・ハイジャックされてしまいます．セッション ID は，Cookie に格納するか，POST メ
    ソッドの hidden パラメータに格納して受け渡しするようにしてください．<br>
    なお，ウェブアプリケーションサーバ製品によっては，利用者が Cookie の受け入れを拒否している
    場合，セッション ID を URL パラメータに格納する実装に自動的に切り替えてしまうものがあります．そ
    のような機能は，製品の設定変更を行う等によって，自動切り替え機能を無効化することを検討してく
    ださい．
    <h3>HTTPS 通信で利用する Cookie には secure 属性を加える</h3>
    ウェブサイトが発行する Cookie には，secure 属性という設定項目があり，これが設定された Cookie
は HTTPS 通信のみで利用されます．Cookie に secure 属性がない場合，HTTPS 通信で発行した
Cookie は，経路が暗号化されていない HTTP 通信でも利用されるため，この HTTP 通信の盗聴により
Cookie 情報を不正に取得されてしまう可能性があります．HTTPS 通信で利用する Cookie には secure
属性を必ず加えてください．かつ，HTTP 通信で Cookie を利用する場合は，HTTPS で発行する Cookie
とは別のものを発行してください．
    <h3>ログイン成功後に，新しくセッションを開始する
    </h3>
    ウェブアプリケーションによっては，ユーザがログインする前の段階（例えばサイトの閲覧を開始した
時点）でセッション ID を発行してセッションを開始し，そのセッションをログイン後も継続して使用する実
装のものがあります．しかしながら，この実装はセッション ID の固定化攻撃に対して脆弱な場合があり
ます．このような実装を避け，ログインが成功した時点から新しいセッションを開始する（新しいセッショ
ン ID でセッション管理をする）ようにします．また，新しいセッションを開始する際には，既存のセッショ
ン ID を無効化します．こうすることにより，利用者が新しくログインしたセッションに対し，悪意のある
人は事前に手に入れたセッション ID ではアクセスできなくなります．
    <h3>ログイン成功後に，既存のセッション ID とは別に秘密情報を発行し，ページの遷移ごとにその値を確認する．</h3>
    セッション ID とは別に，ログイン成功時に秘密情報を作成して Cookie にセットし，この秘密情報とCookie の値が一致することを全てのページで確認するようにします．なお，この秘密情報の作成には，前述の「セッション ID を推測が困難なものにする」と同様の生成アルゴリズムや，暗号処理を用います．<br>
    情報処理推進機構「安全なウェブサイトの作り方」改訂第7版より引用<br>
    <a href="/learn/3session/test1">問題へ進む</a>

</body>
</html>