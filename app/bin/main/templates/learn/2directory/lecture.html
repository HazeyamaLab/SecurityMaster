<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <h2>具体的な脅威の内容</h2>
    外部からのパラメータにウェブサーバ内のファイル名を直接指定する例を見てみましょう．<br>
    ユーザの個人情報などの重要情報をWebサーバ内にテキストファイルとして保存している場合，URLのパラメータとして<br>
    <code>?file=../../secret.txt</code><br>
    など，重要情報のファイルを直接指定すると，サーバ内ファイルの閲覧，改ざん，削除が可能になってしまいます．<br>
    <img th:src="@{/imgs/directory.png}" alt="">
    <h2>脅威への対処法</h2>
    <h3>外部からのパラメータでウェブサーバ内のファイル名を直接指定する実装を避ける</h3>
    外部からのパラメータでウェブサーバ内のファイル名を直接指定する実装では，そのパラメータが改
    変され，任意のファイル名を指定されることにより公開を想定しないファイルが外部から閲覧される可
    能性があります．<br>
    たとえば，HTML 中の hidden パラメータでウェブサーバ内のファイル名を指定し，そ
    のファイルをウェブページのテンプレートとして使用する実装では，そのパラメータが改変されることで，
    任意のファイルをウェブページとして出力してしまう等の可能性があげられます．
    外部からのパラメータでウェブサーバ内のファイル名を直接指定する実装が本当に必要か，他の処
    理方法で代替できないか等，仕様や設計から見直すことをお勧めします．

    <h3>ファイルを開く際は，固定のディレクトリを指定し，かつファイル名にディレクトリ名が含まれないようにする．</h3>
    たとえば，カレントディレクトリ上のファイル「filename」を開くつもりで，open(filename) の形式でコ
    レクトリのファイルが開いてしまう可能性があります．この絶対パス名による指定を回避する方法として，
    あらかじめ固定のディレクトリ「dirname」を指定し，open(dirname+filename) のような形でコーディン
    グする方法があります．しかし，これだけでは，「../」等を使用したディレクトリ・トラバーサル攻撃を回
    避できません．<br>
    これを回避するために，basename() 等の，パス名からファイル名のみを取り出す API
    を利用して，open(dirname+basename(filename)) のような形でコーディングして，filename に与え
    られたパス名からディレクトリ名を取り除くようにします．<br>
    情報処理推進機構「安全なウェブサイトの作り方」改訂第7版より引用<br>
    <a href="/learn/2directory/test1">問題へ進む</a>

</body>
</html>